!function t(e,n,r){function o(i,s){if(!n[i]){if(!e[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var u=n[i]={exports:{}};e[i][0].call(u.exports,function(t){var n=e[i][1][t];return o(n?n:t)},u,u.exports,t,e,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(t){(function(){var e,n;e=t("./transformer.js"),n=["scale","rotate","translate","beforescale","beforerotate","beforetranslate"],angular.module("CK.UI",[]).directive("transformer",function(t){return{scope:{listen:"&",enabled:"=",options:"@"},link:function(r,o,a){var i,s,l,u,c;for(l=r.options||"{}",l=JSON.parse(l),r.transformer=new e(o[0],l),s=t(a.listener),u=0,c=n.length;c>u;u++)i=n[u],r.transformer.on(i,function(t){return r.$apply(function(){return r.listen({_e:t})})});return r.$watch("enabled",function(t){var e,n,o;o=[];for(e in t)n=t[e],o.push(n?r.transformer.enable(e):r.transformer.disable(e));return o},!0)},transclude:!0,template:"<div ng-transclude></div>"}})}).call(this)},{"./transformer.js":2}],2:[function(t,e){(function(){var n,r,o,a,i,s;r=t("./vector.js"),i={"th-topLeft":{vectors:[new r(-1,0),new r(0,-1)]},"th-topCenter":{vectors:[new r(0,-1)]},"th-topRight":{vectors:[new r(0,-1),new r(1,0)]},"th-bottomLeft":{vectors:[new r(0,1),new r(-1,0)]},"th-bottomCenter":{vectors:[new r(0,1)]},"th-bottomRight":{vectors:[new r(0,1),new r(1,0)]},"th-right":{vectors:[new r(1,0)]},"th-left":{vectors:[new r(-1,0)]}},s=function(t,e){var n,r,o;n=e||{};for(r in t)o=t[r],null==n[r]&&(n[r]=o);return n},o={x:0,y:0,width:100,height:100,rotation:0},a={scale:!0,rotate:!0,translate:!0},n=function(t,e){var n,l,u,c,h,d,f,g,v,x;return x=this,g=null,l=null,n=null,v={},f=null,h=function(t,e){var r,u,h,v,y,p;n=t,n.classList.add("ck-transformable"),h=e||{},g=h.state||{},s(o,g),x.setState(g),l=h.enabled||{},s(a,l);for(v in l)y=l[v],y||x.disable(v);for(r in i)p=i[r],u=document.createElement("div"),u.classList.add("handle"),u.classList.add(r),u.setAttribute("name",r),n.appendChild(u);return u=document.createElement("div"),u.classList.add("handle"),u.classList.add("rotHandle"),u.setAttribute("name","rotHandle"),n.appendChild(u),t.addEventListener("mousedown",function(t){var e,r;return t.stopPropagation(),d(t),t.target.classList.contains("rotHandle")?l.rotate&&(e=c.rotationHandleMove,f.activeClass="active-rotHandle"):t.target.classList.contains("handle")?l.scale&&(e=c.scaleHandleMove,f.activeClass="active-"+t.target.getAttribute("name")):l.translate&&(e=c.handleBoxMove,f.activeClass="active-translate"),null!=e?(f.activeClass&&n.classList.add(f.activeClass),document.addEventListener("mousemove",e),r=function(t){return t.stopPropagation(),document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",r),f.activeClass?n.classList.remove(f.activeClass):void 0},document.addEventListener("mouseup",r)):void 0})},x.setState=function(t){var e;return g=t,n.style.top=g.y+"px",n.style.left=g.x+"px",n.style.width=g.width+"px",n.style.height=g.height+"px",e="rotate("+g.rotation+"deg)",n.style["-webkit-transform"]=e,n.style["-ms-transform"]=e,n.style.transform=e,x},x.getState=function(){return s(g)},x.getElement=function(){return n},u=function(t,e,n){var r,o,a;return a=!1,o={name:"before"+t,originalEvent:e,state:n,preventDefault:function(){return a=!0}},x.trigger(o.name,o),a?void 0:(x.setState(n),r={name:t,originalEvent:e,state:n},x.trigger(r.name,r))},d=function(t){var e,n,o,a,l,u,c;if(e=[],n=i[t.target.getAttribute("name")])for(c=n.vectors,l=0,u=c.length;u>l;l++)a=c[l],e.push({original:a,rotated:a.rotate(g.rotation)});return o=new r(g.width/-2,g.height/-2).rotate(g.rotation),f={x:t.pageX,y:t.pageY,vectors:e,origin:{x:g.x+g.width/2,y:g.y+g.height/2},leftCorner:{x:o.x+(g.x+g.width/2),y:o.y+(g.y+g.height/2)},state:s(g)}},c={scaleHandleMove:function(t){var e,n,o,a,i,l,c,h,d,g,v,x,y,p,m,w,b,L;for(t.stopPropagation(),i=new r(t.pageX-f.x,t.pageY-f.y),y=0,l=0,e=0,p=0,m=0,L=f.vectors,w=0,b=L.length;b>w;w++)x=L[w],e=i.dotProduct(x.rotated),0!==x.original.x?(y=e+f.state.width<0?0-f.state.width:e,x.original.x<0&&(p=-1*y)):0!==x.original.y&&(l=e+f.state.height<0?0-f.state.height:e,x.original.y<0&&(m=-1*l));return o={x:f.state.x,y:f.state.y,width:f.state.width+y,height:f.state.height+l},f.state.rotation?(g=f.state.rotation*Math.PI/180,v=Math.sin(g),a=Math.cos(g),h=a*o.width/2-v*o.height/2,d=a*o.height/2+v*o.width/2,n={x:f.leftCorner.x+h,y:f.leftCorner.y+d},c=new r(f.leftCorner.x-n.x,f.leftCorner.y-n.y).rotate(-1*f.state.rotation),o.x=c.x+n.x,o.y=c.y+n.y,(p||m)&&(h=a*p-v*m,d=a*m+v*p,o.x+=h,o.y+=d)):(p||m)&&(o.x+=p,o.y+=m),u("scale",t,s(f.state,o))},rotationHandleMove:function(t){var e,n,r;return t.stopPropagation(),n={x:t.pageX-f.origin.x,y:t.pageY-f.origin.y},r=180*Math.atan(n.y/n.x)/Math.PI+90,n.x<0&&(r+=180),e={rotation:r},u("rotate",t,s(f.state,e))},handleBoxMove:function(t){var e;return t.stopPropagation(),e={x:f.state.x+t.pageX-f.x,y:f.state.y+t.pageY-f.y},u("translate",t,s(f.state,e))}},x.on=function(t,e){return null==v[t]&&(v[t]=[]),~v[t].indexOf(e)||v[t].push(e),x},x.off=function(t,e){var n;if(null!=v[t])return null==e?v[t]=null:(n=v[t].indexOf(e),~n&&v[t].splice(n,1)),x},x.trigger=function(t,e){var n,r,o,a;if(null!=v[t]){for(a=v[t],r=0,o=a.length;o>r;r++)(n=a[r])(e);return x}},x.enable=function(t){return null!=l[t]&&(l[t]=!0,n.classList.remove("disable-"+t)),x},x.disable=function(t){return null!=l[t]&&(l[t]=!1,n.classList.add("disable-"+t)),x},h(t,e)},n.prototype.getOrigin=function(t){return null==t&&(t=this.getState()),{x:t.x+t.width/2,y:t.y+t.height/2}},n.prototype.getBoundingBox=function(t){var e,n,o,a,i,s,l,u,c;for(null==t&&(t=this.getState()),o=this.getOrigin(),i=[new r(t.x-o.x,t.y-o.y).rotate(t.rotation),new r(t.x+t.width-o.x,t.y-o.y).rotate(t.rotation),new r(t.x-o.x,t.y+t.height-o.y).rotate(t.rotation),new r(t.x+t.width-o.x,t.y+t.height-o.y).rotate(t.rotation)],s=Number.MAX_VALUE,n=Number.MAX_VALUE,e=Number.MIN_VALUE,a=Number.MIN_VALUE,u=0,c=i.length;c>u;u++)l=i[u],l.x<n&&(n=l.x),l.x>a&&(a=l.x),l.y<s&&(s=l.y),l.y>e&&(e=l.y);return{x:n+o.x,y:s+o.y,width:a-n,height:e-s}},n.prototype.show=function(){return this.getElement().classList.remove("hide")},n.prototype.hide=function(){return this.getElement().classList.add("hide")},e.exports=n}).call(this)},{"./vector.js":3}],3:[function(t,e){(function(){var t;t=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.rotate=function(e){var n,r,o,a,i;return r=e*Math.PI/180,n=Math.cos(r),o=Math.sin(r),a=this.x*n-this.y*o,i=this.x*o+this.y*n,new t(a,i)},t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y},t}(),e.exports=t}).call(this)},{}]},{},[1]);